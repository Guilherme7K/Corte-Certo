{% extends "base.html" %}

{% block content %}
<div class="min-h-screen py-20 px-6">
    <div class="container mx-auto max-w-4xl">
        
        <!-- Header -->
        <div class="relative mb-16">
            <!-- Background Pattern -->
            <div class="absolute inset-0 bg-gradient-to-br from-surface to-moss rounded-sm overflow-hidden">
                <div class="absolute inset-0 opacity-5" style="background-image: url('https://www.transparenttextures.com/patterns/stardust.png');"></div>
            </div>
            
            <div class="relative z-10 p-12">
                <div class="flex items-start justify-between flex-wrap gap-6">
                    <div>
                        <a href="{{ url_for('cliente_dashboard') }}" class="inline-flex items-center gap-2 text-sand/60 hover:text-clay mb-4 transition-colors text-sm font-mono">
                            <i class="fa-solid fa-arrow-left"></i>
                            Voltar
                        </a>
                        <h1 class="font-display text-5xl md:text-6xl text-sand font-bold mb-2">
                            Novo Agendamento
                        </h1>
                        <p class="text-sand/60 text-sm font-mono tracking-wide">Escolha o serviço e horário ideal</p>
                    </div>
                    
                    <a href="{{ url_for('logout') }}" 
                       class="bg-transparent border border-sand/20 text-sand px-6 py-3 rounded-sm font-display font-bold text-xs uppercase tracking-widest hover:border-clay hover:text-clay transition-all">
                        <i class="fa-solid fa-arrow-right-from-bracket mr-2"></i>Sair
                    </a>
                </div>
            </div>
        </div>

        <!-- Formulário -->
        <div class="bg-surface border border-sand/10 rounded-sm overflow-hidden">
            <!-- Form -->
            <form method="POST" class="p-12 space-y-10">
                
                <!-- Serviços -->
                <div>
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-[1px] bg-clay"></div>
                        <label class="block text-sand font-display text-2xl font-bold">
                            Serviço
                        </label>
                    </div>
                    
                    <div class="grid grid-cols-1 gap-3">
                        {% for servico in servicos %}
                            <label class="relative cursor-pointer group">
                                <input type="radio" 
                                       name="servico_id" 
                                       value="{{ servico.id }}" 
                                       class="peer sr-only" 
                                       required>
                                
                                <div class="border border-sand/10 rounded-sm p-6 transition-all bg-moss
                                           peer-checked:border-clay peer-checked:bg-surface
                                           hover:border-sand/30">
                                    <div class="flex items-center justify-between gap-6">
                                        <div class="flex-1">
                                            <h3 class="font-display text-xl text-sand mb-2 font-bold">
                                                {{ servico.nome }}
                                            </h3>
                                            <p class="text-sand/60 text-sm mb-3 leading-relaxed">{{ servico.descricao }}</p>
                                            <div class="flex items-center gap-6 text-sm">
                                                <span class="text-sand/50 font-mono">
                                                    <i class="fa-solid fa-clock mr-2 text-clay"></i>
                                                    {{ servico.duracao }} min
                                                </span>
                                                <span class="text-clay font-display font-bold text-xl">
                                                    R$ {{ "%.2f"|format(servico.preco) }}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <!-- Checkmark -->
                                        <div class="w-6 h-6 rounded-full border-2 border-sand/20 flex items-center justify-center
                                                   peer-checked:bg-clay peer-checked:border-clay transition-all">
                                            <i class="fa-solid fa-check text-sand text-xs opacity-0 peer-checked:opacity-100"></i>
                                        </div>
                                    </div>
                                </div>
                            </label>
                        {% endfor %}
                    </div>
                </div>

                <!-- Data e Hora -->
                <div>
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-[1px] bg-clay"></div>
                        <label class="block text-sand font-display text-2xl font-bold">
                            Data e Horário
                        </label>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Data -->
                        <div>
                            <label for="data" class="block text-sand/60 text-xs font-mono uppercase tracking-widest mb-3">
                                Data
                            </label>
                            <input 
                                type="date" 
                                id="data" 
                                name="data" 
                                min="{{ today }}"
                                required
                                class="w-full px-5 py-4 bg-moss border border-sand/10 rounded-sm text-sand font-mono
                                       focus:outline-none focus:border-clay transition-all">
                        </div>

                        <!-- Hora -->
                        <div>
                            <label for="hora" class="block text-sand/60 text-xs font-mono uppercase tracking-widest mb-3">
                                Horário
                            </label>
                            <select 
                                id="hora" 
                                name="hora" 
                                required
                                class="w-full px-5 py-4 bg-moss border border-sand/10 rounded-sm text-sand font-mono
                                       focus:outline-none focus:border-clay transition-all appearance-none cursor-pointer">
                                <option value="">Selecione</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="12:00">12:00</option>
                                <option value="12:30">12:30</option>
                                <option value="13:00">13:00</option>
                                <option value="13:30">13:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                                <option value="15:30">15:30</option>
                                <option value="16:00">16:00</option>
                                <option value="16:30">16:30</option>
                                <option value="17:00">17:00</option>
                                <option value="17:30">17:30</option>
                                <option value="18:00">18:00</option>
                                <option value="18:30">18:30</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Observações -->
                <div>
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-[1px] bg-clay"></div>
                        <label class="block text-sand font-display text-2xl font-bold">
                            Observações <span class="text-sand/40 text-base font-normal">(opcional)</span>
                        </label>
                    </div>
                    <textarea 
                        id="observacoes" 
                        name="observacoes" 
                        rows="5"
                        maxlength="500"
                        placeholder="Alguma preferência ou observação especial?"
                        class="w-full px-5 py-4 bg-moss border border-sand/10 rounded-sm text-sand placeholder-sand/30 
                               focus:outline-none focus:border-clay transition-all resize-none font-mono text-sm leading-relaxed"></textarea>
                    <p class="text-sand/40 text-xs mt-2 font-mono">Máximo 500 caracteres</p>
                </div>

                <!-- Informações Importantes -->
                <div class="bg-moss border border-sand/10 rounded-sm p-8">
                    <div class="flex items-center gap-3 mb-4">
                        <i class="fa-solid fa-info-circle text-clay text-lg"></i>
                        <h4 class="font-display text-sand font-bold text-lg">Informações importantes</h4>
                    </div>
                    <ul class="text-sand/60 text-sm space-y-3 font-mono">
                        <li class="flex items-start gap-3">
                            <i class="fa-solid fa-chevron-right text-clay text-xs mt-1"></i>
                            <span>Horário: Segunda a Sábado, 9h às 19h</span>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fa-solid fa-chevron-right text-clay text-xs mt-1"></i>
                            <span>Chegue com 5 minutos de antecedência</span>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="fa-solid fa-chevron-right text-clay text-xs mt-1"></i>
                            <span>Cancelamentos: mínimo 2 horas de antecedência</span>
                        </li>
                    </ul>
                </div>

                <!-- Botões -->
                <div class="flex flex-col md:flex-row gap-4 pt-6">
                    <a href="{{ url_for('cliente_dashboard') }}" 
                       class="flex-1 bg-transparent border border-sand/20 text-sand px-8 py-4 rounded-sm font-display font-bold text-xs uppercase tracking-widest hover:border-sand/40 transition-all text-center">
                        Cancelar
                    </a>
                    <button 
                        type="submit" 
                        class="flex-1 bg-clay hover:bg-clay/90 text-sand px-8 py-4 rounded-sm font-display font-bold text-xs uppercase tracking-widest transition-all hover:scale-[1.02] shadow-lg">
                        <i class="fa-solid fa-check mr-2"></i>
                        Confirmar Agendamento
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Definir data mínima como hoje
    const dataInput = document.getElementById('data');
    const hoje = new Date().toISOString().split('T')[0];
    dataInput.min = hoje;

    // Bloquear domingos
    dataInput.addEventListener('change', function() {
        const dataSelecionada = new Date(this.value + 'T00:00:00');
        if (dataSelecionada.getDay() === 0) {
            alert('Não abrimos aos domingos. Por favor, selecione outro dia.');
            this.value = '';
        }
    });
</script>
{% endblock %}
