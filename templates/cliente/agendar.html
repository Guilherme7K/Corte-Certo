{% extends "base.html" %}

{% block content %}
<div class="min-h-screen py-20 px-6">
    <div class="container mx-auto max-w-4xl">
        
        <!-- Header -->
        <div class="text-center mb-12">
            <a href="{{ url_for('cliente_dashboard') }}" class="inline-flex items-center gap-2 text-sand/60 hover:text-sand mb-4 transition-colors">
                <i class="fa-solid fa-arrow-left"></i>
                Voltar ao Dashboard
            </a>
            <h1 class="font-display text-4xl md:text-5xl text-sand syne-extra mb-3">
                Novo Agendamento
            </h1>
            <p class="text-sand/60">Selecione o serviço, data e horário</p>
        </div>

        <!-- Formulário -->
        <div class="bg-[#0d140c] border border-sand/10 rounded-xl shadow-2xl overflow-hidden">
            
            <!-- Header do Card -->
            <div class="bg-gradient-to-br from-clay to-clay/80 p-8 text-center relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-sand/10 rounded-full blur-3xl"></div>
                <i class="fa-solid fa-calendar-check text-sand text-4xl mb-3 relative z-10"></i>
                <h2 class="font-display text-2xl text-sand relative z-10">Reserve seu horário</h2>
            </div>

            <!-- Form -->
            <form method="POST" class="p-8 space-y-8">
                
                <!-- Serviços -->
                <div>
                    <label class="block text-sand text-sm font-medium mb-4">
                        <i class="fa-solid fa-scissors mr-2 text-clay"></i>
                        Escolha o Serviço <span class="text-clay">*</span>
                    </label>
                    
                    <div class="grid grid-cols-1 gap-4">
                        {% for servico in servicos %}
                            <label class="relative cursor-pointer group">
                                <input type="radio" 
                                       name="servico_id" 
                                       value="{{ servico.id }}" 
                                       class="peer sr-only" 
                                       required>
                                
                                <div class="border-2 border-sand/20 rounded-xl p-6 transition-all
                                           peer-checked:border-clay peer-checked:bg-clay/10
                                           hover:border-sand/40">
                                    <div class="flex items-center justify-between">
                                        <div class="flex-1">
                                            <h3 class="font-display text-xl text-sand mb-1 group-hover:text-clay transition-colors">
                                                {{ servico.nome }}
                                            </h3>
                                            <p class="text-sand/60 text-sm mb-2">{{ servico.descricao }}</p>
                                            <div class="flex items-center gap-4 text-sm">
                                                <span class="text-sand/50">
                                                    <i class="fa-solid fa-clock mr-1"></i>
                                                    {{ servico.duracao }} min
                                                </span>
                                                <span class="text-clay font-bold text-lg">
                                                    R$ {{ "%.2f"|format(servico.preco) }}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <!-- Checkmark -->
                                        <div class="w-8 h-8 rounded-full border-2 border-sand/30 flex items-center justify-center
                                                   peer-checked:bg-clay peer-checked:border-clay transition-all ml-4">
                                            <i class="fa-solid fa-check text-sand text-sm opacity-0 peer-checked:opacity-100"></i>
                                        </div>
                                    </div>
                                </div>
                            </label>
                        {% endfor %}
                    </div>
                </div>

                <!-- Data e Hora -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Data -->
                    <div>
                        <label for="data" class="block text-sand text-sm font-medium mb-2">
                            <i class="fa-solid fa-calendar mr-2 text-clay"></i>
                            Data <span class="text-clay">*</span>
                        </label>
                        <input 
                            type="date" 
                            id="data" 
                            name="data" 
                            min="{{ today }}"
                            required
                            class="w-full px-4 py-3 bg-moss border border-sand/20 rounded-lg text-sand 
                                   focus:outline-none focus:border-clay focus:ring-2 focus:ring-clay/20 transition-all">
                    </div>

                    <!-- Hora -->
                    <div>
                        <label for="hora" class="block text-sand text-sm font-medium mb-2">
                            <i class="fa-solid fa-clock mr-2 text-clay"></i>
                            Horário <span class="text-clay">*</span>
                        </label>
                        <select 
                            id="hora" 
                            name="hora" 
                            required
                            class="w-full px-4 py-3 bg-moss border border-sand/20 rounded-lg text-sand 
                                   focus:outline-none focus:border-clay focus:ring-2 focus:ring-clay/20 transition-all appearance-none cursor-pointer">
                            <option value="">Selecione um horário</option>
                            <option value="09:00">09:00</option>
                            <option value="09:30">09:30</option>
                            <option value="10:00">10:00</option>
                            <option value="10:30">10:30</option>
                            <option value="11:00">11:00</option>
                            <option value="11:30">11:30</option>
                            <option value="12:00">12:00</option>
                            <option value="12:30">12:30</option>
                            <option value="13:00">13:00</option>
                            <option value="13:30">13:30</option>
                            <option value="14:00">14:00</option>
                            <option value="14:30">14:30</option>
                            <option value="15:00">15:00</option>
                            <option value="15:30">15:30</option>
                            <option value="16:00">16:00</option>
                            <option value="16:30">16:30</option>
                            <option value="17:00">17:00</option>
                            <option value="17:30">17:30</option>
                            <option value="18:00">18:00</option>
                            <option value="18:30">18:30</option>
                        </select>
                    </div>
                </div>

                <!-- Observações -->
                <div>
                    <label for="observacoes" class="block text-sand text-sm font-medium mb-2">
                        <i class="fa-solid fa-comment mr-2 text-clay"></i>
                        Observações <span class="text-sand/50 text-xs">(opcional)</span>
                    </label>
                    <textarea 
                        id="observacoes" 
                        name="observacoes" 
                        rows="4"
                        maxlength="500"
                        placeholder="Alguma preferência ou observação especial?"
                        class="w-full px-4 py-3 bg-moss border border-sand/20 rounded-lg text-sand placeholder-sand/40 
                               focus:outline-none focus:border-clay focus:ring-2 focus:ring-clay/20 transition-all resize-none"></textarea>
                    <p class="text-sand/50 text-xs mt-1.5">Máximo 500 caracteres</p>
                </div>

                <!-- Informações Importantes -->
                <div class="bg-moss/50 border border-clay/20 rounded-lg p-6">
                    <h4 class="font-display text-sand font-bold mb-3 flex items-center gap-2">
                        <i class="fa-solid fa-info-circle text-clay"></i>
                        Informações importantes
                    </h4>
                    <ul class="text-sand/70 text-sm space-y-2">
                        <li class="flex items-start gap-2">
                            <i class="fa-solid fa-check text-clay text-xs mt-1"></i>
                            <span>Horário de funcionamento: Segunda a Sábado, 9h às 19h</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fa-solid fa-check text-clay text-xs mt-1"></i>
                            <span>Chegue com 5 minutos de antecedência</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fa-solid fa-check text-clay text-xs mt-1"></i>
                            <span>Cancelamentos devem ser feitos com pelo menos 2 horas de antecedência</span>
                        </li>
                    </ul>
                </div>

                <!-- Botões -->
                <div class="flex gap-4 pt-4">
                    <a href="{{ url_for('cliente_dashboard') }}" 
                       class="flex-1 bg-moss border border-sand/20 text-sand px-6 py-4 rounded-lg font-display font-bold text-sm uppercase tracking-wide hover:border-sand/40 transition-colors text-center">
                        Cancelar
                    </a>
                    <button 
                        type="submit" 
                        class="flex-1 bg-clay hover:bg-clay/90 text-sand px-6 py-4 rounded-lg font-display font-bold text-sm uppercase tracking-wide transition-colors shadow-lg shadow-clay/20">
                        <i class="fa-solid fa-check mr-2"></i>
                        Confirmar Agendamento
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Definir data mínima como hoje
    const dataInput = document.getElementById('data');
    const hoje = new Date().toISOString().split('T')[0];
    dataInput.min = hoje;

    // Bloquear domingos
    dataInput.addEventListener('change', function() {
        const dataSelecionada = new Date(this.value + 'T00:00:00');
        if (dataSelecionada.getDay() === 0) {
            alert('Não abrimos aos domingos. Por favor, selecione outro dia.');
            this.value = '';
        }
    });
</script>
{% endblock %}
